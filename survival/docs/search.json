[
  {
    "objectID": "dist_weibull.html",
    "href": "dist_weibull.html",
    "title": "1  Distribuição Weibull",
    "section": "",
    "text": "1.1 Função de verossimilhança é dada por:\nA função densidade de probabilidade associada a variável aleatória tempo até o evento \\(t\\), possui uma grande variedade de formas, sendo sua função densidade, possuindo uma propriedade básica: a função taxa de falha sendo monótona, ou seja, crescente, decrescente ou constante.\nCom distribuição Weibull é dada por:\n\\[\nf(t) = \\frac{\\gamma}{\\alpha^{\\gamma}}\\cdot t^{(\\gamma-1)} \\cdot exp\\left[-\\left(\\frac{t}{\\alpha}\\right)^{\\gamma} \\right], \\ t&gt;0\n\\]\nE função de sobrevivência dada por:\n\\[\nS(t) = exp\\left[ - \\left(\\frac{t_{i}}{\\alpha}\\right)^{\\gamma}\\right]\n\\]\nOs parâmetros de escala e forma, \\(\\alpha\\) e \\(\\gamma\\) são positivos. O parâmetro \\(\\alpha\\) tem mesma medida de unidade de \\(t\\) e \\(\\gamma\\) não tendo unidade de medida.\n\\[\nL(\\theta | t) = \\prod_{i=1}^{n} \\left[ \\left( \\frac{\\gamma}{\\alpha^{\\gamma}} \\cdot t_{i}^{\\gamma-1} \\cdot \\exp\\left[ -\\left( \\frac{t_{i}}{\\alpha} \\right)^{\\gamma} \\right] \\right)^{\\delta_{i}} \\cdot \\left( \\exp\\left[ -\\left( \\frac{t_{i}}{\\alpha} \\right)^{\\gamma} \\right] \\right)^{1-\\delta_{i}} \\right]\n\\]",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Distribuição Weibull</span>"
    ]
  },
  {
    "objectID": "dist_weibull.html#log-verossimilhança-da-weibull",
    "href": "dist_weibull.html#log-verossimilhança-da-weibull",
    "title": "1  Distribuição Weibull",
    "section": "1.2 Log-verossimilhança da Weibull:",
    "text": "1.2 Log-verossimilhança da Weibull:\n\\[\n\\ell[L(\\theta | t)] = \\sum_{i=1}^{n} \\left[ \\delta_{i} \\log \\left( \\frac{\\gamma}{\\alpha^{\\gamma}} \\cdot t_{i}^{\\gamma-1} \\right) - \\left( \\frac{t_{i}}{\\alpha} \\right)^{\\gamma} \\right]\n\\]\n\\[\n\\ell[L(\\theta | t)] = \\sum_{i=1}^{n} \\left[ \\delta_{i} \\left[ \\log(\\gamma) - \\gamma \\log(\\alpha) + (\\gamma - 1) \\log(t_{i}) \\right] - \\left( \\frac{t_{i}}{\\alpha} \\right)^{\\gamma} \\right]\n\\]",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Distribuição Weibull</span>"
    ]
  },
  {
    "objectID": "dist_exponencial.html",
    "href": "dist_exponencial.html",
    "title": "1  Distribuição Exponencial",
    "section": "",
    "text": "1.1 Função de verossimilhança\nA função densidade de probabilidade associada a variável aleatória tempo até o evento \\(t\\) com distribuição exponencial e função de sobrevivência é dada por:\n\\[\nf(t) = \\frac{1}{\\alpha} \\cdot exp\\left[-\\frac{t}{\\alpha}\\right] \\ ; \\ S(t)= exp\\left[-\\frac{t}{\\alpha}\\right]\\ t &gt; 0  \n\\]\nComo o parâmetro \\(\\alpha &gt; 0\\) correspondendo ao tempo médio de vida.\n\\[\nL(\\theta | t_{i}) = \\prod_{i = 1}^{n} \\left[\\frac{1}{\\alpha} \\cdot exp\\left[-\\frac{t_{i}}{\\alpha}\\right]\\right]^{\\delta_{i}}\n\\]\n\\[\n= \\left[\\frac{1}{\\alpha} \\cdot exp\\left[-\\frac{t_{1}}{\\alpha}\\right]\\right]^{\\delta_{i}} \\cdot \\left[exp\\left[-\\frac{t_{2}}{\\alpha}\\right]\\right]^{1-\\delta_{i}}\n\\]\n\\[\n= \\left[\\frac{1}{\\alpha^{n}}\\right]^{\\delta_{i}} \\cdot exp\\left(-\\frac{\\sum_{i=1}^{n}ti}{\\alpha}\\right)\n\\]\nPodendo ser reescrita:\n\\[\n= 1^{\\delta_{i}} \\cdot \\alpha^{-n\\cdot\\delta_{i}} \\cdot exp\\left(-\\frac{\\sum_{i=1}^{n}ti}{\\alpha}\\right)\n\\]\nSabendo que \\(\\delta_{i}=\\{0,1\\}\\), aplicando em \\(1^{\\delta_{i}}\\) se tem 1 multiplicando \\(\\alpha\\), logo, a função de verossimilhança será:\n\\[\n= \\alpha^{-n\\cdot\\delta_{i}} \\cdot exp\\left(-\\frac{\\sum_{i=1}^{n}ti}{\\alpha}\\right)\n\\]",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Distribuição Exponencial</span>"
    ]
  },
  {
    "objectID": "dist_exponencial.html#a-log-verossimilhança-da-exponencial",
    "href": "dist_exponencial.html#a-log-verossimilhança-da-exponencial",
    "title": "1  Distribuição Exponencial",
    "section": "1.2 A Log-verossimilhança da exponencial",
    "text": "1.2 A Log-verossimilhança da exponencial\n\\[\nl[L(\\hat{\\theta}|t_{i})] = \\log\\left[\\alpha^{-n\\cdot\\delta_{i}} \\cdot exp\\left(-\\frac{\\sum_{i=1}^{n}ti}{\\alpha}\\right) \\right] = -n\\cdot \\delta_{i}\\cdot \\log(\\alpha) -\\frac{\\sum_{i=1}^{n}t_{i}}{\\alpha}\n\\]\nDerivando em relação a \\(\\alpha\\) teremos que:\n\\[\n\\frac{\\partial l[L(\\hat{\\theta}|t_{i})]}{\\partial\\alpha} = \\frac{-n\\cdot\\delta_{i}}{\\alpha} + \\frac{\\sum_{i=1}^{n}t_{i}}{\\alpha^{2}} = 0\n\\]\n\\[\n\\frac{-n\\cdot\\delta_{i}}{\\alpha} + \\frac{\\sum_{i=1}^{n}t_{i}}{\\alpha^{2}} = 0 \\ \\cdot (\\alpha^{2})\n\\]\n\\[\n= -n\\cdot\\delta_{i}\\cdot \\alpha + \\sum_{i=1}^{n}t_{i} = 0\n\\]\n\\[\n\\sum_{i=1}^{n} t_{i} = n \\cdot \\delta_{i} \\cdot \\alpha\n\\]\n\\[\n\\hat{\\alpha} = \\frac{\\sum_{i=1}^{n}t_{i}}{n\\cdot\\delta_{i}}\n\\]\nNa ausência de censura, aplicando \\(\\delta_{i}={1}\\), teremos:\n\\[\n\\hat{\\alpha} = \\frac{\\sum_{i=1}^{n}t_{i}}{n}\n\\]\nQue é exatamente a média amostral de \\(t_{i}\\).\n\n# Verificando como os dados do livro: câncer de bexiga\n\n# Ajuste conforme a distribuição\n\najust1_cc_bx &lt;- survreg(Surv(tempos,cens)~1,dist = \"exponential\")\najust2_cc_bx &lt;- survreg(Surv(tempos,cens)~1,dist = \"weibull\")\najust3_cc_bx &lt;- survreg(Surv(tempos,cens)~1,dist = \"lognorm\")\n# Ekm  dos dados\n\nekm_cc_bx &lt;- survfit(Surv(tempos,cens)~1)\ntime &lt;- ekm_cc_bx$time\nst &lt;- ekm_cc_bx$surv\n\n# Cálculo dos parâmetros estimados das distribuições\n\nalpha&lt;- round(exp(ajust1_cc_bx$coefficients[1]),2 )\nalpha2&lt;-  round(exp(ajust2_cc_bx$coefficients[1]),2 )\ngama2&lt;-1/ajust2_cc_bx$scale\n\nmi &lt;-  round(ajust3_cc_bx$coefficients[1],2)\nalpha3 &lt;- round(ajust3_cc_bx$scale,2)\n\nste_cc_bx&lt;-exp(-time/alpha)\n\nstw_cc_bx&lt;- exp(-(time/alpha2)^gama2)\n\nstln_cc_bx&lt;- pnorm((-log(time)+ mi)/alpha3)\n\npar(mfrow=c(1,3))\n plot(st, ste_cc_bx, pch=16, ylim=c(0,1), xlim=c(0,1), \n      xlab = \"S(t): Kaplan-Meier\", ylab=\"S(t): exponencial\",\n      cex.lab=1.5,cex.axis=1.3)\n abline(a=0,b=1)\n\n plot(st, stw_cc_bx, pch=16, ylim=c(0,1), xlim=c(0,1), \n      xlab = \"S(t): Kaplan-Meier\", ylab=\"S(t): weibull\",\n      cex.lab=1.5,cex.axis=1.3)\n abline(a=0,b=1)\n\n plot(st, stln_cc_bx, pch=16, ylim=c(0,1), xlim=c(0,1), \n      xlab = \"S(t): Kaplan-Meier\", ylab=\"S(t): log-normal\",\n      cex.lab=1.5,cex.axis=1.3)\n abline(a=0,b=1)\n\npar(mfrow=c(1,3),mar=c(5,5,2,2)); \ninvst&lt;-qnorm(st) \nplot(time,-log(st),pch=16,xlab=\"Tempo\",ylab=\"-log(S(t))\") \nplot(log(time),log(-log(st)),pch=16,xlab=\"log(Tempo)\",ylab=\"log(-log(S(t)))\") \nplot(log(time),invst,pch=16,xlab=\"log(Tempo)\",ylab=expression(Phi^-1*(S(t))))\n\npar(mfrow=c(1,2)) \nplot(ekm_cc_bx,conf.int=F,xlab=\"Tempo\",ylab=\"S(t)\"); lines(c(0,time),c(1,stw_cc_bx),lty=2) \nlegend(25,0.8,lty=c(1,2),c(\"Kaplan-Meier\",\"Weibull\"),bty=\"n\",cex=0.9) \nplot(ekm_cc_bx,conf.int=F,xlab=\"Tempo\",ylab=\"S(t)\"); lines(c(0,time),c(1,stln_cc_bx),lty=2) \nlegend(25,0.8,lty=c(1,2),c(\"Kaplan-Meier\",\"Log-normal\"),bty=\"n\",cex=0.9)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Distribuição Exponencial</span>"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Análise de sobrevivência aplicado a dados epidemiológicos",
    "section": "",
    "text": "Objetivo\nVerificar comportamento de distribuições de probabilidade em dados para aplicação de análise de sobrevivência. Para tal, se deve obter estimadores de máximo verossimilhança utilizando as funções \\(optim\\) e \\(optimize\\) para identificar os valores dos parâmetros estimados, convergência dos dados sob a distribuição de interesse.\nAlém da aplicabilidade, se deve conhecer cada distribuição, seus pressupostos, características, propriedades e comportamento gráfico em relação aos dados.\nPara comparação, se utiliza-se os pacotes implementados do \\(R\\) para aplicar análise de sobrevivência com o \\(survival\\), vizualização gráfica com o pacote \\(ggplot2\\) e leitura de banco de dados com \\(readxl\\).\nAplicando a função de sobrevivência com funções criadas apartir dos resultados de convergência para certa distribuição.\nOs dados utilizados são:\n\ncancer_de_pele.txt\npacientes com câncer de bexiga\n\n\n1 e 2 foram bases retiradas do repositório dos autores do livro Análise de Sobrevivência, Colossimo & Giolo: Acesse aqui;",
    "crumbs": [
      "Objetivo"
    ]
  },
  {
    "objectID": "dist_log_norm.html",
    "href": "dist_log_norm.html",
    "title": "2  Distribuição Log-normal",
    "section": "",
    "text": "2.1 Função de verossimilhança\nA função densidade de probabilidade associada a variável aleatória tempo até o evento \\(T\\) com distribuição log-normal e função de sobrevivência é dada por:\n\\[\nf(t) = \\frac{1}{\\sqrt{2\\pi} \\cdot t \\cdot \\sigma} \\cdot exp\\left[ \\frac{1}{2\\sigma^{2}} \\cdot (\\log(t) - \\mu)^{2} \\right] \\ ; \\ S(t)= \\Phi \\left(\\frac{-\\log(t) + \\mu}{\\sigma} \\right) t &gt; 0\n\\]\n\\[\nL(\\theta|t_{i}) = \\prod_{i=1}^{n} \\left[\\frac{1}{\\sqrt{2\\pi} \\cdot t \\cdot \\sigma} \\cdot exp\\left[ \\frac{1}{2\\sigma^{2}} \\cdot (\\log(t) - \\mu)^{2} \\right] \\right]\n\\]\n\\[\nL(\\hat{\\theta}|t_{i}) = \\frac{1}{(\\sqrt{2\\pi})^{n} \\cdot t_{i} \\cdot \\sigma^{n}} \\cdot exp\\left[-\\frac{1}{2\\sigma^{2}} \\cdot \\sum_{i=1}^{n} \\left(\\log(t_{i}) - \\mu\\right)^{2} \\right]\n\\]\nReescrevendo, teremos:\n\\[  \nL(\\hat{\\theta}|t_{i}) = (2\\pi)^{\\left(-\\frac{n}{2}\\right)}\\cdot \\sigma^{-n} \\cdot \\prod_{i=1}^{n} t_{i}^{-1} \\cdot exp\\left[-\\frac{1}{2\\sigma^{2}} \\cdot \\sum_{i=1}^{n} \\left(\\log(t_{i}) - \\mu\\right)^{2} \\right]\n\\]",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Distribuição Log-normal</span>"
    ]
  },
  {
    "objectID": "dist_log_norm.html#log-verossimilhança-da-log-normal",
    "href": "dist_log_norm.html#log-verossimilhança-da-log-normal",
    "title": "2  Distribuição Log-normal",
    "section": "2.2 Log-verossimilhança da Log-Normal:",
    "text": "2.2 Log-verossimilhança da Log-Normal:\n\\[\nl[L\\hat{\\theta}| t_{i}] = \\log \\left[ (2\\pi)^{\\left(-\\frac{n}{2}\\right)}\\cdot \\sigma^{-n} \\cdot \\prod_{i=1}^{n} t_{i}^{-1} \\cdot exp\\left[-\\frac{1}{2\\sigma^{2}} \\cdot \\sum_{i=1}^{n} \\left(\\log(t_{i}) - \\mu\\right)^{2} \\right]\\right]\n\\]\nlogo, temos:\n\\[\n= -\\frac{n}{2} \\cdot \\left[\\log(2) + log(\\pi)\\right]-n\\cdot \\log(\\sigma) \\cdot -\\sum_{i=1}^{n} \\log(t_{i}) -\\frac{1}{2\\sigma^{2}} \\cdot \\sum_{i=1}^{n}\\left( \\log(t_{i}) - \\mu\\right)^{2}\n\\]\nDerivando parcialmente \\(\\hat{\\theta}=(\\mu,\\alpha)\\) se obtem:\n\\[\n\\frac{\\partial l[L(\\hat{\\theta} | t_{i})]}{\\partial \\mu} = -\\frac{1}{2\\sigma^{2}}\\cdot \\sum_{i=1}^{n} (\\log(t_{i})-\\mu)^{2}=\n\\]\n\\[\n= -\\frac{1}{2\\sigma^{2}}\\cdot 2 \\cdot \\sum_{i=1}^{n} (\\log(t_{i})-\\mu) \\cdot (-1)=\n\\]\n\\[\n= \\frac{1}{\\sigma^{2}} \\cdot \\sum_{i=1}^{n} (\\log(t_{i})-\\mu)\n\\]\n\\[\n\\frac{\\partial l[L(\\hat{\\theta} | t_{i})]}{\\partial \\sigma} = \\frac{n}{\\sigma} - \\left[\\frac{1}{2} \\cdot (\\sigma^{-2})' \\cdot \\sum_{i=1}^{n} (\\log(t_i) - \\mu)^2 \\right] =\n\\]\n\\[\n=-\\frac{n}{\\sigma} - \\left[ -\\frac{2}{2} \\cdot \\sigma^{-3} \\cdot \\sum_{i=1}^{n} (\\log(t_i) - \\mu)^2 \\right] =\n\\]\n\\[\n= -\\frac{n}{\\sigma} + \\frac{1}{\\sigma^{3}} \\cdot \\sum_{i=1}^{n} (\\log(t_i) - \\mu)^2\n\\]\nCom \\(\\hat{\\mu}\\) e \\(\\hat{\\sigma}\\), respectivamente:\n\\[\n\\hat{\\mu} = \\frac{\\sum_{i=1}^{n} \\log(t_{i})}{n} \\ ; \\ \\hat{\\sigma}= \\frac{\\sum_{i=1}^{n} (\\log(t_{i})-\\mu)^{2}}{n}\n\\]",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Distribuição Log-normal</span>"
    ]
  },
  {
    "objectID": "dist_log_logis.html",
    "href": "dist_log_logis.html",
    "title": "3  Distribuição Log-logística",
    "section": "",
    "text": "3.1 Função de Sobrevivência\nA função densidade de probabilidade associada a variável aleatória tempo até o evento \\(T\\) com distribuição log-logística é dada por:\n\\[\nf(t) = \\frac{\\gamma}{\\alpha^{\\gamma}} \\cdot t^{(\\gamma-1)} \\left[ 1 + \\left(\\frac{t}{\\alpha} \\right)^\\gamma \\right]^{-2}\n\\]\n\\[\nS(t) = \\frac{1}{1 + \\left(\\frac{t}{\\alpha} \\right)^\\gamma}\n\\]",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Distribuição Log-logística</span>"
    ]
  },
  {
    "objectID": "dist_log_logis.html#função-verossimilhança",
    "href": "dist_log_logis.html#função-verossimilhança",
    "title": "3  Distribuição Log-logística",
    "section": "3.2 Função verossimilhança",
    "text": "3.2 Função verossimilhança\n\\[\nL(\\theta | t) = \\prod_{i=1}^{n} \\left[ \\left( \\frac{\\gamma}{\\alpha^\\gamma} \\cdot t_i^{\\gamma-1} \\left[ 1 + \\left( \\frac{t_i}{\\alpha} \\right)^\\gamma \\right]^{-2} \\right)^{\\delta_i} \\cdot \\left( \\frac{1}{1 + \\left( \\frac{t_i}{\\alpha} \\right)^\\gamma} \\right)^{1-\\delta_i} \\right]\n\\]\n\\[\n\\ell[L(\\theta | t)] = \\sum_{i=1}^{n} \\left[ \\delta_i \\log \\left( \\frac{\\gamma}{\\alpha^\\gamma} \\cdot t_i^{\\gamma-1} \\left[ 1 + \\left( \\frac{t_i}{\\alpha} \\right)^\\gamma \\right]^{-2} \\right) +  (1-\\delta_i) \\log \\left( \\frac{1}{1 + \\left( \\frac{t_i}{\\alpha} \\right)^\\gamma} \\right) \\right]\n\\]\n\\[\n= \\sum_{i=1}^{n} \\left[ \\delta_i \\left( \\log(\\gamma) - \\gamma \\log(\\alpha) + (\\gamma-1) \\log(t_i) - 2 \\log \\left( 1 + \\left( \\frac{t_i}{\\alpha} \\right)^\\gamma \\right) \\right) + \\\\[10pt] (1-\\delta_i) \\log \\left( \\frac{1}{1 + \\left( \\frac{t_i}{\\alpha} \\right)^\\gamma} \\right) \\right]\n\\]\nAplicando uma expansão dos termos nas duas últimas partes da expressão, se pode simplificar da seguinte forma:\n\\[\n= -2 \\delta_i \\log \\left( 1 + \\left( \\frac{t_i}{\\alpha} \\right)^\\gamma \\right) + \\log \\left( \\frac{1}{1 + \\left( \\frac{t_i}{\\alpha} \\right)^\\gamma} \\right) - \\delta_i \\log \\left( \\frac{1}{1 + \\left( \\frac{t_i}{\\alpha} \\right)^\\gamma} \\right)\n\\]\n\\[\n= -2\\delta_i \\log \\left( 1 + \\left( \\frac{t_i}{\\alpha} \\right)^\\gamma \\right) + \\log \\left( \\frac{1}{1 + \\left( \\frac{t_i}{\\alpha} \\right)^\\gamma} \\right) + \\delta_i \\log \\left( 1 + \\left( \\frac{t_i}{\\alpha} \\right)^\\gamma \\right)\n\\]\n\\[\n= -\\delta_i \\log \\left( 1 + \\left( \\frac{t_i}{\\alpha} \\right)^\\gamma \\right) + \\log \\left( \\frac{1}{1 + \\left( \\frac{t_i}{\\alpha} \\right)^\\gamma} \\right)\n\\]\nLogo, a expressão final:\n\\[\n\\\\[10pt]\n= \\sum_{i=1}^{n} \\left[ \\delta_i \\left[ \\log(\\gamma) - \\gamma \\log(\\alpha) + (\\gamma-1) \\log(t_i) - \\log \\left( 1 + \\left( \\frac{t_i}{\\alpha} \\right)^\\gamma \\right) + \\log \\left( \\frac{1}{1 + \\left( \\frac{t_i}{\\alpha} \\right)^\\gamma} \\right) \\right] \\right]\n\\]",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Distribuição Log-logística</span>"
    ]
  },
  {
    "objectID": "dist_weibull.html#distribuição-log-weibull-gumbel",
    "href": "dist_weibull.html#distribuição-log-weibull-gumbel",
    "title": "1  Distribuição Weibull",
    "section": "1.3 Distribuição Log-Weibull (Gumbel)",
    "text": "1.3 Distribuição Log-Weibull (Gumbel)\n\\[L(\\theta | y) = \\prod_{i=1}^n \\left[ \\left( \\frac{1}{\\sigma} \\exp \\left[ \\frac{y_i - \\mu}{\\sigma} - \\exp \\left( \\frac{y_i - \\mu}{\\sigma} \\right) \\right] \\right)^{\\delta_i} \\cdot \\left( \\exp \\left[ -\\exp \\left( \\frac{y_i - \\mu}{\\sigma} \\right) \\right] \\right)^{1-\\delta_i} \\right]\\]\n\\[\\ell[L(\\theta | y)] = \\sum_{i=1}^n \\left[ \\delta_i \\log \\left[ \\frac{1}{\\sigma} \\exp \\left( \\frac{y_i - \\mu}{\\sigma} \\right) \\right] - \\exp \\left( \\frac{y_i - \\mu}{\\sigma} \\right) \\right]\\]\n\\[\\ell[L(\\theta | y)] = \\sum_{i=1}^n \\left[ \\delta_i \\left[ -\\log(\\sigma) + \\left( \\frac{y_i - \\mu}{\\sigma} \\right) \\right] - \\exp \\left( \\frac{y_i - \\mu}{\\sigma} \\right) \\right]\\]",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Distribuição Weibull</span>"
    ]
  }
]